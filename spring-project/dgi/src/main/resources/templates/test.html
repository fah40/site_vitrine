<!DOCTYPE html>
<html>
<head>
    <title>Éditeur Quill Avancé</title>
    <link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
    <script src="https://cdn.quilljs.com/1.3.6/quill.min.js"></script>
    <style>
        #editor-container {
            height: 300px;
        }
    </style>
</head>
<body>

    <form th:action="@{/sauvegarder}" method="post">
        <!-- Barre d'outils -->
        <div id="toolbar">
            <!-- Titres -->
            <select class="ql-header">
                <option selected>Normal</option>
                <option value="1">Titre 1</option>
                <option value="2">Titre 2</option>
                <option value="3">Titre 3</option>
            </select>

            <!-- Mise en forme -->
            <button class="ql-bold"></button>
            <button class="ql-italic"></button>
            <button class="ql-underline"></button>
            <button class="ql-strike"></button>

            <!-- Couleurs -->
            <select class="ql-color"></select>
            <select class="ql-background"></select>

            <!-- Listes -->
            <button class="ql-list" value="ordered"></button>
            <button class="ql-list" value="bullet"></button>

            <!-- Alignement -->
            <select class="ql-align"></select>

            <!-- Liens et images -->
            <button class="ql-link"></button>
            <button class="ql-image"></button>

            <!-- Citation & Code -->
            <button class="ql-blockquote"></button>
            <button class="ql-code-block"></button>
        </div>

        <!-- Zone d'édition -->
        <div id="editor-container"></div>
        <input type="hidden" name="contenu" id="contenu">

        <button type="submit" onclick="document.getElementById('contenu').value = quill.root.innerHTML">
            Enregistrer
        </button>
    </form>

<script>
    var quill = new Quill('#editor-container', {
        theme: 'snow',
        modules: {
            toolbar: '#toolbar'
        }
    });

    // Associer les classes aux niveaux de titres
    const headerClassMap = {
        "": "classe1",  // Normal
        "1": "classe2", // Titre 1
        "2": "classe3", // Titre 2
        "3": "classe4"  // Titre 3
    };

    // Écoute les changements dans le select
    document.querySelector(".ql-header").addEventListener("change", function() {
        let selection = quill.getSelection();
        if (selection) {
            let headerValue = this.value;
            let className = headerClassMap[headerValue] || "classe1"; 

            // Appliquer la classe sur la sélection
            quill.format("header", headerValue || false);
            quill.format("class", className);
        }
    });

    // Sauvegarde le contenu en incluant les classes
    document.querySelector("button[type='submit']").addEventListener("click", function() {
        document.getElementById("contenu").value = quill.root.innerHTML;
    });
</script>


</body>
</html>
